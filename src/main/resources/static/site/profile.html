<!DOCTYPE html>
<html style="font-size: 16px;">

  <head>
      <meta http-equiv="Pragma" content="no-cache">
      <meta http-equiv="Expires" content="-1">
      <meta http-equiv="CACHE-CONTROL" content="NO-CACHE">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <meta name="keywords" content="">
    <meta name="description" content="">
    <meta name="page_type" content="np-template-header-footer-from-plugin">
    <title>Профиль</title>
    <link rel="stylesheet" href="nicepage.css" media="screen">
<link rel="stylesheet" href="Профиль.css" media="screen">
    <script class="u-script" type="text/javascript" src="jquery.js" defer=""></script>
    <script class="u-script" type="text/javascript" src="nicepage.js" defer=""></script>
    <meta name="generator" content="Nicepage 4.2.6, nicepage.com">
    <link id="u-theme-google-font" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i|Open+Sans:300,300i,400,400i,600,600i,700,700i,800,800i">
    
    
    <script type="application/ld+json">{
		"@context": "http://schema.org",
		"@type": "Organization",
		"name": "",
		"logo": "images/logo.png"
}</script>
    <meta name="theme-color" content="#478ac9">
    <meta property="og:title" content="Профиль">
    <meta property="og:type" content="website">
  </head>
  <body class="u-body"><header class="u-clearfix u-header u-header" id="sec-2346"><div class="u-clearfix u-sheet u-sheet-1">
        <a href="/" data-page-id="65723904" class="u-image u-logo u-image-1" data-image-width="300" data-image-height="187" title="Главная страница">
          <img src="images/logo.png" class="u-logo-image u-logo-image-1">
        </a>
        <nav class="u-menu u-menu-dropdown u-offcanvas u-menu-1">
          <div class="menu-collapse" style="font-size: 1rem; letter-spacing: 0px;">
            <a class="u-button-style u-custom-left-right-menu-spacing u-custom-padding-bottom u-custom-top-bottom-menu-spacing u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="#">
              <svg viewBox="0 0 24 24"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#menu-hamburger"></use></svg>
              <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><symbol id="menu-hamburger" viewBox="0 0 16 16" style="width: 16px; height: 16px;"><rect y="1" width="16" height="2"></rect><rect y="7" width="16" height="2"></rect><rect y="13" width="16" height="2"></rect>
</symbol>
</defs></svg>
            </a>
          </div>
          <div class="u-custom-menu u-nav-container">
            <ul class="u-nav u-unstyled u-nav-1"><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="/" style="padding: 10px 20px;">Главная страница</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="/profile" style="padding: 10px 20px;">Профиль</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="/basket" style="padding: 10px 20px;">Корзина</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="/find" style="padding: 10px 20px;">Поиск</a>
</li></ul>
          </div>
          <div class="u-custom-menu u-nav-container-collapse">
            <div class="u-black u-container-style u-inner-container-layout u-opacity u-opacity-95 u-sidenav">
              <div class="u-inner-container-layout u-sidenav-overflow">
                <div class="u-menu-close"></div>
                <ul class="u-align-center u-nav u-popupmenu-items u-unstyled u-nav-2"><li class="u-nav-item"><a class="u-button-style u-nav-link" href="/" style="padding: 10px 20px;">Главная страница</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="/profile" style="padding: 10px 20px;">Профиль</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="/basket" style="padding: 10px 20px;">Корзина</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="/find" style="padding: 10px 20px;">Поиск</a>
</li></ul>
              </div>
            </div>
            <div class="u-black u-menu-overlay u-opacity u-opacity-70"></div>
          </div>
        </nav>
      </div></header>

    <section class="u-clearfix u-grey-5 u-section-1" id="sec-82f7">
      <div id="to-insert" class="u-clearfix u-sheet u-valign-middle u-sheet-1">
        <h3 class="u-align-center u-text u-text-1">Ваш профиль</h3>

      </div>
    </section>

  <script>
      window.onload = login;
      var mass;

      function setCookie(cName, cValue, expDays) {
          let date = new Date();
          date.setTime(date.getTime() + (expDays * 24 * 60 * 60 * 1000));
          const expires = "expires=" + date.toUTCString();
          document.cookie = cName + "=" + cValue + "; " + expires + "; path=/";
      }

      async function login() {
          var container = document.getElementById('to-insert');

          while (container.firstChild) {
              container.removeChild(container.firstChild);
          }

          let url = 'http://localhost:4040/getProfile';
          let it = document.cookie.split('; ');
          let email = '';
          let password = '';
          for(let i = 0; i < it.length; i++){
              let submass = it[i].split('=');
              if(submass[0] === 'password') {
                  password = submass[1];
              }
              if(submass[0] === 'email') {
                  email = submass[1];
              }
          }

          let response = await fetch(url, {
              method: 'GET',
              headers: {
                  'Content-type': 'application/json',
                  'email': email,
                  'password': password
              }
          });

          if (!response.ok) {
              alert("Ошибка HTTP: " + response.status);
              return;
          }

          let json = await response.json();
          let result = JSON.stringify(json);
          mass = JSON.parse(result);

          document.getElementById('to-insert').insertAdjacentHTML("beforeend", "        " +
              "<div  class=\"u-form u-form-1\">" +
              "<form action=\"#\" method=\"POST\" class=\"u-clearfix u-form-spacing-10 u-form-vertical u-inner-form\" source=\"custom\" name=\"form\" style=\"padding: 10px;\">\n" +
              "            <div class=\"u-form-group u-form-name\">\n" +
              "              <label for=\"name-319c\" class=\"u-form-control-hidden u-label\"></label>\n" +
              "              <input type=\"text\" placeholder=\""+mass['name']+"\" id=\"F1\" name=\"name\" class=\"u-border-1 u-border-grey-30 u-input u-input-rectangle u-white\" required=\"\">\n" +
              "            </div>\n" +
              "            <div class=\"u-form-group u-form-name u-form-group-2\">\n" +
              "              <label for=\"name-3e09\" class=\"u-form-control-hidden u-label\"></label>\n" +
              "              <input type=\"text\" placeholder=\""+mass['surname']+"\" id=\"F2\" name=\"surname\" class=\"u-border-1 u-border-grey-30 u-input u-input-rectangle u-white\" required=\"\">\n" +
              "            </div>\n" +
              "            <div class=\"u-form-email u-form-group\">\n" +
              "              <label for=\"email-319c\" class=\"u-form-control-hidden u-label\"></label>\n" +
              "              <input type=\"email\" placeholder=\""+mass['email']+"\" id=\"F3\" name=\"email\" class=\"u-border-1 u-border-grey-30 u-input u-input-rectangle u-white\" required=\"\">\n" +
              "            </div>\n" +
              "            <div class=\"u-form-group u-form-phone u-form-group-4\">\n" +
              "              <label for=\"phone-2be9\" class=\"u-form-control-hidden u-label\"></label>\n" +
              "              <input type=\"tel\" pattern=\"\\+?\\d{0,3}[\\s\\(\\-]?([0-9]{2,3})[\\s\\)\\-]?([\\s\\-]?)([0-9]{3})[\\s\\-]?([0-9]{2})[\\s\\-]?([0-9]{2})\" placeholder=\""+mass['phone']+"\" id=\"F4\" name=\"phone\" class=\"u-border-1 u-border-grey-30 u-input u-input-rectangle u-white\" required=\"\">\n" +
              "            </div>\n" +
              "            <div class=\"u-form-group u-form-group-5\">\n" +
              "              <label for=\"text-76dc\" class=\"u-form-control-hidden u-label\"></label>\n" +
              "              <input type=\"text\" placeholder=\"Ваш новый пароль\" id=\"F5\" name=\"password\" class=\"u-border-1 u-border-grey-30 u-input u-input-rectangle u-white\">\n" +
              "            </div>\n" +
              "            <div class=\"u-form-address u-form-group u-form-group-6\">\n" +
              "              <label for=\"address-e9c9\" class=\"u-form-control-hidden u-label\"></label>\n" +
              "              <input type=\"text\" placeholder=\""+mass['address']['country']+"\" id=\"F6\" name=\"country\" class=\"u-border-1 u-border-grey-30 u-input u-input-rectangle u-white\" required=\"\">\n" +
              "            </div>\n" +
              "            <div class=\"u-form-address u-form-group u-form-group-7\">\n" +
              "              <label for=\"address-de8e\" class=\"u-form-control-hidden u-label\"></label>\n" +
              "              <input type=\"text\" placeholder=\""+mass['address']['city']+"\" id=\"F7\" name=\"city\" class=\"u-border-1 u-border-grey-30 u-input u-input-rectangle u-white\" required=\"\">\n" +
              "            </div>\n" +
              "            <div class=\"u-form-address u-form-group u-form-group-8\">\n" +
              "              <label for=\"address-08d4\" class=\"u-form-control-hidden u-label\"></label>\n" +
              "              <input type=\"text\" placeholder=\""+mass['address']['street']+"\" id=\"F8\" name=\"street\" class=\"u-border-1 u-border-grey-30 u-input u-input-rectangle u-white\" required=\"\">\n" +
              "            </div>\n" +
              "            <div class=\"u-form-address u-form-group u-form-group-9\">\n" +
              "              <label for=\"address-283b\" class=\"u-form-control-hidden u-label\"></label>\n" +
              "              <input type=\"text\" placeholder=\""+mass['address']['house']+"\" id=\"F9\" name=\"house\" class=\"u-border-1 u-border-grey-30 u-input u-input-rectangle u-white\" required=\"\">\n" +
              "            </div>\n" +
              "            <div class=\"u-form-address u-form-group u-form-group-10\">\n" +
              "              <label for=\"address-fb83\" class=\"u-form-control-hidden u-label\"></label>\n" +
              "              <input type=\"text\" placeholder=\""+mass['address']['flat']+"\" id=\"F10\" name=\"flat\" class=\"u-border-1 u-border-grey-30 u-input u-input-rectangle u-white\" required=\"\">\n" +
              "            </div>\n" +
              "            <div class=\"u-align-left u-form-group u-form-submit\">\n" +
              "              <a id=\"INPUT\" href=\"\" class=\"u-btn u-btn-submit u-button-style\">Отправить</a>\n" +
              "              <input type=\"submit\" value=\"submit\" class=\"u-form-control-hidden\">\n" +
              "            </div>\n" +
              "          </form>" +
              "        </div>");
          document.getElementById("INPUT").addEventListener("mousedown", async function () {
              let url = 'http://localhost:4040/login';

              let it = document.cookie.split('; ');
              let email = '';
              let password = '';
              for(let i = 0; i < it.length; i++){
                  let submass = it[i].split('=');
                  if(submass[0] === 'password') {
                      password = submass[1];
                  }
                  if(submass[0] === 'email') {
                      email = submass[1];
                  }
              }

              let NewMass = [];

              for(let i = 0; i < 10; i++){
                  if(document.getElementById('F' + (i + 1)).value !== ""){
                      NewMass[i] = document.getElementById('F' + (i + 1)).value;
                  }
                  else{
                      if(document.getElementById('F' + (i + 1)).name === 'flat' ||
                          document.getElementById('F' + (i + 1)).name === 'house' ||
                          document.getElementById('F' + (i + 1)).name === 'street' ||
                          document.getElementById('F' + (i + 1)).name === 'city' ||
                          document.getElementById('F' + (i + 1)).name === 'country'){
                          NewMass[i] = mass['address'][document.getElementById('F' + (i + 1)).name];
                      }
                      else {
                          NewMass[i] = mass[document.getElementById('F' + (i + 1)).name];
                      }
                  }
              }

              var data = JSON.stringify({
                  "address": {
                      "city": NewMass[5],
                      "country": NewMass[6],
                      "flat": NewMass[7],
                      "house": NewMass[8],
                      "street": NewMass[9]
                  },
                  "email": NewMass[2],
                  "id": 0,
                  "name": NewMass[0],
                  "password": NewMass[4],
                  "phone": NewMass[3],
                  "surname": NewMass[1]});

              fetch(url, {
                  method: 'put',
                  body: data,
                  headers: new Headers({
                      'Content-Type': 'application/json',
                      'email': email,
                      'password': password
                  })
              }).then(function(response) {
                  if (!response.ok) {
                      throw new Error("HTTP status " + response.status);
                  }
                  else{
                      setCookie('email', NewMass[2], 365);
                      setCookie('password', NewMass[4], 365);
                  }
              })
              window.setTimeout(function () {
                  login();
              }, 2000);
          });
      }
  </script>
    
    <footer class="u-align-center u-clearfix u-footer u-grey-80 u-footer" id="sec-1f20"><div class="u-align-left u-clearfix u-sheet u-sheet-1"></div></footer>
    <section class="u-backlink u-clearfix u-grey-80">
      <a class="u-link" href="https://nicepage.com/website-templates" target="_blank">
        <span>Website Templates</span>
      </a>
      <p class="u-text">
        <span>created with</span>
      </p>
      <a class="u-link" href="" target="_blank">
        <span>Website Builder Software</span>
      </a>. 
    </section>
  </body>
</html>