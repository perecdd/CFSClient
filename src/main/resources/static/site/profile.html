<!DOCTYPE html>

<style>
    .u-section-1 {
        background-image: none;
    }

    .u-section-1 .u-sheet-1 {
        min-height: 768px;
    }

    .u-section-1 .u-list-1 {
        grid-template-rows: auto auto;
        width: 1140px;
        margin: 20px 0 0;
    }

    .u-section-1 .u-repeater-1 {
        grid-template-columns: calc(50% - 15px) calc(50% - 15px);
        grid-gap: 30px 30px;
        min-height: 618px;
    }

    .u-section-1 .u-list-item-1 {
        background-image: none;
    }

    .u-section-1 .u-container-layout-1 {
        padding: 30px 0 30px 30px;
    }

    .u-section-1 .u-image-1 {
        width: 255px;
        height: 249px;
        margin: 0 auto 0 0;
    }

    .u-section-1 .u-group-1 {
        width: 270px;
        min-height: 254px;
        background-size: auto;
        height: auto;
        margin: -249px 0 0 auto;
    }

    .u-section-1 .u-container-layout-2 {
        padding: 0 25px 0 35px;
    }

    .u-section-1 .u-text-1 {
        margin: 20px 0 0;
    }

    .u-section-1 .u-text-2 {
        font-style: italic;
        margin: 0;
    }

    .u-section-1 .u-text-3 {
        margin: 20px 0 0;
    }

    .u-section-1 .u-text-4 {
        font-weight: 700;
        margin: 20px 0 0;
    }

    .u-section-1 .u-btn-1 {
        border-style: none;
        text-transform: uppercase;
        background-image: none;
        font-size: 0.875rem;
        margin: 20px 0 0;
    }

    .u-section-1 .u-list-item-2 {
        background-size: auto;
    }

    .u-section-1 .u-container-layout-3 {
        padding: 30px 0 30px 30px;
    }

    .u-section-1 .u-image-2 {
        width: 255px;
        height: 249px;
        margin: 0 auto 0 0;
    }

    .u-section-1 .u-group-2 {
        width: 270px;
        min-height: 254px;
        background-size: auto;
        height: auto;
        margin: -249px 0 0 auto;
    }

    .u-section-1 .u-container-layout-4 {
        padding: 0 25px 0 35px;
    }

    .u-section-1 .u-text-5 {
        margin: 20px 0 0;
    }

    .u-section-1 .u-text-6 {
        font-style: italic;
        margin: 0;
    }

    .u-section-1 .u-text-7 {
        margin: 20px 0 0;
    }

    .u-section-1 .u-text-8 {
        font-weight: 700;
        margin: 20px 0 0;
    }

    .u-section-1 .u-btn-2 {
        border-style: none;
        text-transform: uppercase;
        background-image: none;
        font-size: 0.875rem;
        margin: 20px 0 0;
    }

    .u-section-1 .u-list-item-3 {
        background-size: auto;
    }

    .u-section-1 .u-container-layout-5 {
        padding: 30px 0 30px 30px;
    }

    .u-section-1 .u-image-3 {
        width: 255px;
        height: 249px;
        margin: 0 auto 0 0;
    }

    .u-section-1 .u-group-3 {
        width: 270px;
        min-height: 254px;
        background-size: auto;
        height: auto;
        margin: -249px 0 0 auto;
    }

    .u-section-1 .u-container-layout-6 {
        padding: 0 25px 0 35px;
    }

    .u-section-1 .u-text-9 {
        margin: 20px 0 0;
    }

    .u-section-1 .u-text-10 {
        font-style: italic;
        margin: 0;
    }

    .u-section-1 .u-text-11 {
        margin: 20px 0 0;
    }

    .u-section-1 .u-text-12 {
        font-weight: 700;
        margin: 20px 0 0;
    }

    .u-section-1 .u-btn-3 {
        border-style: none;
        text-transform: uppercase;
        background-image: none;
        font-size: 0.875rem;
        margin: 20px 0 0;
    }

    .u-section-1 .u-list-item-4 {
        background-size: auto;
    }

    .u-section-1 .u-container-layout-7 {
        padding: 30px 0 30px 30px;
    }

    .u-section-1 .u-image-4 {
        width: 255px;
        height: 249px;
        margin: 0 auto 0 0;
    }

    .u-section-1 .u-group-4 {
        width: 270px;
        min-height: 254px;
        background-size: auto;
        height: auto;
        margin: -249px 0 0 auto;
    }

    .u-section-1 .u-container-layout-8 {
        padding: 0 25px 0 35px;
    }

    .u-section-1 .u-text-13 {
        margin: 20px 0 0;
    }

    .u-section-1 .u-text-14 {
        font-style: italic;
        margin: 0;
    }

    .u-section-1 .u-text-15 {
        margin: 20px 0 0;
    }

    .u-section-1 .u-text-16 {
        font-weight: 700;
        margin: 20px 0 0;
    }

    .u-section-1 .u-btn-4 {
        border-style: none;
        text-transform: uppercase;
        background-image: none;
        font-size: 0.875rem;
        margin: 20px 0 0;
    }

    .u-section-1 .u-btn-5 {
        border-style: none;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 1px;
        margin: 30px auto 20px;
    }

    @media (max-width: 1199px) {
        .u-section-1 .u-list-1 {
            width: 940px;
        }

        .u-section-1 .u-image-1 {
            width: 155px;
        }

        .u-section-1 .u-group-1 {
            height: auto;
        }

        .u-section-1 .u-image-2 {
            width: 155px;
        }

        .u-section-1 .u-group-2 {
            height: auto;
        }

        .u-section-1 .u-image-3 {
            width: 155px;
        }

        .u-section-1 .u-group-3 {
            height: auto;
        }

        .u-section-1 .u-image-4 {
            width: 155px;
        }

        .u-section-1 .u-group-4 {
            height: auto;
        }
    }

    @media (max-width: 991px) {
        .u-section-1 .u-list-1 {
            width: 720px;
        }

        .u-section-1 .u-repeater-1 {
            grid-template-columns: 100%;
        }

        .u-section-1 .u-image-1 {
            width: 300px;
        }

        .u-section-1 .u-group-1 {
            width: 377px;
        }

        .u-section-1 .u-container-layout-2 {
            padding-left: 30px;
        }

        .u-section-1 .u-image-2 {
            width: 300px;
        }

        .u-section-1 .u-group-2 {
            width: 377px;
        }

        .u-section-1 .u-container-layout-4 {
            padding-left: 30px;
        }

        .u-section-1 .u-image-3 {
            width: 300px;
        }

        .u-section-1 .u-group-3 {
            width: 377px;
        }

        .u-section-1 .u-container-layout-6 {
            padding-left: 30px;
        }

        .u-section-1 .u-image-4 {
            width: 300px;
        }

        .u-section-1 .u-group-4 {
            width: 377px;
        }

        .u-section-1 .u-container-layout-8 {
            padding-left: 30px;
        }
    }

    @media (max-width: 767px) {
        .u-section-1 .u-list-1 {
            width: 540px;
        }

        .u-section-1 .u-image-1 {
            width: 245px;
        }

        .u-section-1 .u-group-1 {
            width: 265px;
        }

        .u-section-1 .u-container-layout-2 {
            padding-right: 30px;
        }

        .u-section-1 .u-image-2 {
            width: 245px;
        }

        .u-section-1 .u-group-2 {
            width: 265px;
        }

        .u-section-1 .u-container-layout-4 {
            padding-right: 30px;
        }

        .u-section-1 .u-image-3 {
            width: 245px;
        }

        .u-section-1 .u-group-3 {
            width: 265px;
        }

        .u-section-1 .u-container-layout-6 {
            padding-right: 30px;
        }

        .u-section-1 .u-image-4 {
            width: 245px;
        }

        .u-section-1 .u-group-4 {
            width: 265px;
        }

        .u-section-1 .u-container-layout-8 {
            padding-right: 30px;
        }
    }

    @media (max-width: 575px) {
        .u-section-1 .u-list-1 {
            height: auto;
            margin-right: initial;
            margin-left: initial;
            width: auto;
        }

        .u-section-1 .u-container-layout-1 {
            padding-left: 20px;
            padding-right: 20px;
        }

        .u-section-1 .u-image-1 {
            height: 200px;
            margin-right: initial;
            margin-left: initial;
            width: auto;
        }

        .u-section-1 .u-group-1 {
            margin-top: 0;
            margin-right: initial;
            margin-left: initial;
            width: auto;
        }

        .u-section-1 .u-container-layout-2 {
            padding-top: 30px;
            padding-left: 0;
            padding-right: 0;
        }

        .u-section-1 .u-text-1 {
            margin-top: 0;
        }

        .u-section-1 .u-text-2 {
            margin-right: auto;
        }

        .u-section-1 .u-btn-1 {
            margin-right: auto;
        }

        .u-section-1 .u-container-layout-3 {
            padding-left: 20px;
            padding-right: 20px;
        }

        .u-section-1 .u-image-2 {
            height: 200px;
            margin-right: initial;
            margin-left: initial;
            width: auto;
        }

        .u-section-1 .u-group-2 {
            margin-top: 0;
            margin-right: initial;
            margin-left: initial;
            width: auto;
        }

        .u-section-1 .u-container-layout-4 {
            padding-top: 30px;
            padding-left: 0;
            padding-right: 0;
        }

        .u-section-1 .u-text-5 {
            margin-top: 0;
            margin-right: auto;
        }

        .u-section-1 .u-text-6 {
            margin-right: auto;
        }

        .u-section-1 .u-btn-2 {
            margin-right: auto;
        }

        .u-section-1 .u-container-layout-5 {
            padding-left: 20px;
            padding-right: 20px;
        }

        .u-section-1 .u-image-3 {
            height: 200px;
            margin-right: initial;
            margin-left: initial;
            width: auto;
        }

        .u-section-1 .u-group-3 {
            margin-top: 0;
            margin-right: initial;
            margin-left: initial;
            width: auto;
        }

        .u-section-1 .u-container-layout-6 {
            padding-top: 30px;
            padding-left: 0;
            padding-right: 0;
        }

        .u-section-1 .u-text-9 {
            margin-top: 0;
        }

        .u-section-1 .u-container-layout-7 {
            padding-left: 20px;
            padding-right: 20px;
        }

        .u-section-1 .u-image-4 {
            height: 200px;
            margin-right: initial;
            margin-left: initial;
            width: auto;
        }

        .u-section-1 .u-group-4 {
            margin-top: 0;
            margin-right: initial;
            margin-left: initial;
            width: auto;
        }

        .u-section-1 .u-container-layout-8 {
            padding-top: 30px;
            padding-left: 0;
            padding-right: 0;
        }

        .u-section-1 .u-text-13 {
            margin-top: 0;
        }
    }
</style>
<html style="font-size: 16px;">

<style>
    .boxLink {
        color: black;
        text-decoration: none
    }

    .boxLink:active {
        color: black;
        text-decoration: none
    }

    .boxLink:visited {
        color: black;
        text-decoration: none
    }

    .boxLink:hover {
        color: black;
        text-decoration: none
    }
</style>

<style>
    .u-section-1 .u-sheet-1 {
        min-height: 383px;
    }

    .u-section-1 .u-list-1 {
        grid-template-rows: auto;
        margin-top: -9px;
        margin-bottom: 20px;
    }

    .u-section-1 .u-repeater-1 {
        grid-template-columns: 33.3333% 33.3333% 33.3333%;
        min-height: 372px;
        grid-gap: 0px 0px;
    }

    .u-section-1 .u-container-layout-1 {
        padding: 20px 30px 11px;
    }

    .u-section-1 .u-image-1 {
        height: 260px;
        width: 260px;
        margin: 0 auto;
    }

    .u-section-1 .u-text-1 {
        margin: 20px auto 0 0;
    }

    .u-section-1 .u-text-2 {
        margin: 11px 0 0;
    }

    .u-section-1 .u-text-3 {
        text-align: left;
        margin: 11px 0 0;
    }

    .u-section-1 .u-container-layout-2 {
        padding: 20px 30px 11px;
    }

    .u-section-1 .u-image-2 {
        height: 260px;
        width: 260px;
        margin: 0 auto;
    }

    .u-section-1 .u-text-4 {
        margin: 20px auto 0 0;
    }

    .u-section-1 .u-text-5 {
        margin: 11px 0 0;
    }

    .u-section-1 .u-text-6 {
        text-align: left;
        margin: 11px 0 0;
    }

    .u-section-1 .u-container-layout-3 {
        padding: 20px 30px 11px;
    }

    .u-section-1 .u-image-3 {
        height: 260px;
        width: 260px;
        margin: 0 auto;
    }

    .u-section-1 .u-text-7 {
        margin: 20px auto 0 0;
    }

    .u-section-1 .u-text-8 {
        margin: 11px 0 0;
    }

    .u-section-1 .u-text-9 {
        text-align: left;
        margin: 11px 0 0;
    }

    @media (max-width: 1199px) {
        .u-section-1 .u-repeater-1 {
            grid-template-columns: repeat(3, 33.333333333333336%);
            min-height: 307px;
        }
    }

    @media (max-width: 991px) {
        .u-section-1 .u-repeater-1 {
            grid-template-columns: repeat(2, 50%);
            min-height: 705px;
        }
    }

    @media (max-width: 767px) {
        .u-section-1 .u-repeater-1 {
            grid-template-columns: 100%;
        }

        .u-section-1 .u-container-layout-1 {
            padding-left: 10px;
            padding-right: 10px;
        }

        .u-section-1 .u-container-layout-2 {
            padding-left: 10px;
            padding-right: 10px;
        }

        .u-section-1 .u-container-layout-3 {
            padding-left: 10px;
            padding-right: 10px;
        }
    }
</style>

<script>
    async function loadTickets() {
        let it = document.cookie.split('; ');
        let email = '';
        let password = '';
        for (let i = 0; i < it.length; i++) {
            let submass = it[i].split('=');
            if (submass[0] === 'password') {
                password = submass[1];
            }
            if (submass[0] === 'email') {
                email = submass[1];
            }
        }

        let url = 'http://localhost:4040/user-tickets';

        let response = await fetch(url, {
            method: 'GET',
            headers: {
                'Content-type': 'application/json',
                'email': email,
                'password': password
            }
        });

        if (response.ok) {
            let json = await response.json();
            let result = JSON.stringify(json);
            let mass = JSON.parse(result);
            for (let i = 0; i < result.length; i++) {
                if(mass[i] === undefined) break;
                if(mass[i]['status'] !== 'cancel' && mass[i]['status'] !== 'canceled' && mass[i]['status'] !== 'success' && mass[i]['status'] !== 'successful') {
                    let j = 0;
                    addContainer(i, mass[i]['id'], mass[i]['status']);
                    addCancelButton(mass[i]['id']);
                    while (mass[i]['products'][j] !== undefined) {
                        addCode(mass[i]['products'][j]["Photo"], mass[i]['products'][j]["companyid"], mass[i]['products'][j]["count"], mass[i]['products'][j]["description"], mass[i]['products'][j]["name"], mass[i]['products'][j]["price"], mass[i]['products'][j]["productid"], i);
                        j++;
                    }
                }
                else if(mass[i]['status'] !== 'cancel' && mass[i]['status'] !== 'canceled' && mass[i]['status'] !== 'successful'){
                    let j = 0;
                    addContainer(i, mass[i]['id'], mass[i]['status']);
                    addRatingButton(mass[i]['products'][j]['companyid'], mass[i]['id']);
                    while (mass[i]['products'][j] !== undefined) {
                        addCode(mass[i]['products'][j]["Photo"], mass[i]['products'][j]["companyid"], mass[i]['products'][j]["count"], mass[i]['products'][j]["description"], mass[i]['products'][j]["name"], mass[i]['products'][j]["price"], mass[i]['products'][j]["productid"], i);
                        j++;
                    }
                }
            }
        } else {
            alert("Ошибка HTTP: " + response.status);
        }
    }

    function addContainer(table_number, id, status){
        document.getElementById("sec-da98").insertAdjacentHTML("beforeend", "" +
            "    <div class=\"u-clearfix u-sheet u-sheet-1\">\n" +
            "        <div class=\"u-expanded-width u-list u-list-1\">\n" +
            "            <h4 class=\"u-text u-text-2\">Заказ номер: "+id+"; Состояние: "+status+"</h4>"+
            "            <div id=\"to-insert-"+table_number+"\" class=\"u-repeater u-repeater-1\">\n" +
            "            </div>\n" +
            "        </div>\n" +
            "    </div>");
    }

    async function cancelOrder(orderNumber) {
        let it = document.cookie.split('; ');
        let email = '';
        let password = '';
        for (let i = 0; i < it.length; i++) {
            let submass = it[i].split('=');
            if (submass[0] === 'password') {
                password = submass[1];
            }
            if (submass[0] === 'email') {
                email = submass[1];
            }
        }

        let url = 'http://localhost:4040/user-tickets';

        let response = await fetch(url, {
            method: 'POST',
            headers: {
                'email': email,
                'password': password,
                'ticket': orderNumber
            }
        });

        if (response.ok) {
            window.location.href = '/profile';
        }
    }

    async function rate(companyid, orderNumber) {
        let it = document.cookie.split('; ');
        let email = '';
        let password = '';
        for (let i = 0; i < it.length; i++) {
            let submass = it[i].split('=');
            if (submass[0] === 'password') {
                password = submass[1];
            }
            if (submass[0] === 'email') {
                email = submass[1];
            }
        }

        let url = 'http://localhost:4040/user-tickets';

        let response = await fetch(url, {
            method: 'POST',
            headers: {
                'email': email,
                'password': password,
                'ticket': orderNumber
            }
        });

        if (response.ok) {
            url = 'http://localhost:4040/rating';

            let response = await fetch(url, {
                method: 'POST',
                headers: {
                    'email': email,
                    'password': password,
                    'companyid': companyid
                }
            });

            window.location.href = '/profile';
        }
    }

    function addRatingButton(companyid, orderNumber){
        document.getElementById("sec-da98").insertAdjacentHTML("beforeend", "" +
            "<form class=\"u-clearfix u-sheet\" target=\"_blank\"  action=\"/auth\" method=\"POST\" class=\"u-clearfix u-form-spacing-10 u-form-vertical u-inner-form\" source=\"custom\" name=\"form\" style=\"padding: 10px;\">\n" +
            "        <div class=\"u-align-center u-form-group u-form-submit\">\n" +
            "             <label for=\"text-6c59\" class=\"u-form-control-hidden u-label\"></label>\n" +
            "             <input id=\"NUM12\" type=\"number\" placeholder=\"Введите количество\" value=\"0\" min=\"0\" max=\"10\" name=\"text\" class=\"u-border-1 u-border-grey-30 u-input u-input-rectangle u-white\" required>\n" +
            "        </div>\n" +
            "        <div class=\"u-align-center u-form-group u-form-submit\">\n" +
            "            <a onclick=\"rate("+companyid+", " + orderNumber + ")\" class=\"u-btn u-btn-submit u-button-style\">Оценить заказ</a>\n" +
            "            <input type=\"submit\" value=\"submit\" class=\"u-form-control-hidden\">\n" +
            "        </div>\n" +
            "    </form>");
        document.getElementById("NUM12").addEventListener("keyup", function (){
            if(Number(this.value) > Number(10)) this.value = 10;
            if(Number(this.value) < Number(0)) this.value = 0;
        });
        document.getElementById("NUM12").addEventListener("mouseup", function (){
            if(Number(this.value) > Number(10)) this.value = 10;
            if(Number(this.value) < Number(0)) this.value = 0;
        });
    }

    function addCancelButton(orderNumber){
        document.getElementById("sec-da98").insertAdjacentHTML("beforeend", "" +
            "<form target=\"_blank\"  action=\"/auth\" method=\"POST\" class=\"u-clearfix u-form-spacing-10 u-form-vertical u-inner-form\" source=\"custom\" name=\"form\" style=\"padding: 10px;\">\n" +
            "        <div class=\"u-align-center u-form-group u-form-submit\">\n" +
            "            <a onclick=\"cancelOrder("+orderNumber+")\" class=\"u-btn u-btn-submit u-button-style\">Отменить заказ</a>\n" +
            "            <input type=\"submit\" value=\"submit\" class=\"u-form-control-hidden\">\n" +
            "        </div>\n" +
            "    </form>");
    }

    function addCode(Photo, companyid, count, description, name, price, productid, table_number) {
        document.getElementById("to-insert-" + table_number).insertAdjacentHTML("beforeend", "" +
            "            <div id=\"container-" + productid + "\" class=\"u-container-style u-list-item u-repeater-item\">\n" +
            "              <div class=\"u-container-layout u-similar-container u-valign-top u-container-layout-1\">\n" +
            "<a class=\"boxLink\"\"><table border=\"1px solid grey;\">" +
            "                <tr><td><img alt=\"\" class=\"u-image u-image-default u-image-1\" data-image-width=\"2000\" data-image-height=\"1333\" src=\"" + Photo + "\"></tr></td>\n" +
            "                <tr><td><h3 class=\"u-text u-text-default u-text-1\">" + name + "</h3></tr></td>\n" +
            "                <tr><td><p class=\"u-text u-text-2\">Количество: " + count + "</p></tr></td>\n" +
            "                <tr><td><p class=\"u-text u-text-2\">Описание: " + description + "</p></tr></td>\n" +
            "                <tr><td><p class=\"u-text u-text-3\">Цена: " + price + "</p></tr></td>\n" +
            "                <tr><td><p class=\"u-text u-text-3\">ID: " + productid + "</p></tr></td>\n" +
            "</table></a>" +
            "              </div>\n" +
            "            </div>");
    }
</script>

  <head>
      <meta http-equiv="Pragma" content="no-cache">
      <meta http-equiv="Expires" content="-1">
      <meta http-equiv="CACHE-CONTROL" content="NO-CACHE">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <meta name="keywords" content="">
    <meta name="description" content="">
    <meta name="page_type" content="np-template-header-footer-from-plugin">
    <title>Профиль</title>
    <link rel="stylesheet" href="nicepage.css" media="screen">
<link rel="stylesheet" href="Профиль.css" media="screen">
    <script class="u-script" type="text/javascript" src="jquery.js" defer=""></script>
    <script class="u-script" type="text/javascript" src="nicepage.js" defer=""></script>
    <meta name="generator" content="Nicepage 4.2.6, nicepage.com">
    <link id="u-theme-google-font" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i|Open+Sans:300,300i,400,400i,600,600i,700,700i,800,800i">
    
    
    <script type="application/ld+json">{
		"@context": "http://schema.org",
		"@type": "Organization",
		"name": "",
		"logo": "images/logo.png"
}</script>
    <meta name="theme-color" content="#478ac9">
    <meta property="og:title" content="Профиль">
    <meta property="og:type" content="website">
  </head>
  <body class="u-body"><header class="u-clearfix u-header u-header" id="sec-2346"><div class="u-clearfix u-sheet u-sheet-1">
        <a href="/" data-page-id="65723904" class="u-image u-logo u-image-1" data-image-width="300" data-image-height="187" title="Главная страница">
          <img src="images/logo.png" class="u-logo-image u-logo-image-1">
        </a>
        <nav class="u-menu u-menu-dropdown u-offcanvas u-menu-1">
          <div class="menu-collapse" style="font-size: 1rem; letter-spacing: 0px;">
            <a class="u-button-style u-custom-left-right-menu-spacing u-custom-padding-bottom u-custom-top-bottom-menu-spacing u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="#">
              <svg viewBox="0 0 24 24"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#menu-hamburger"></use></svg>
              <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><symbol id="menu-hamburger" viewBox="0 0 16 16" style="width: 16px; height: 16px;"><rect y="1" width="16" height="2"></rect><rect y="7" width="16" height="2"></rect><rect y="13" width="16" height="2"></rect>
</symbol>
</defs></svg>
            </a>
          </div>
          <div class="u-custom-menu u-nav-container">
            <ul class="u-nav u-unstyled u-nav-1"><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="/" style="padding: 10px 20px;">Главная страница</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="/profile" style="padding: 10px 20px;">Профиль</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="/basket" style="padding: 10px 20px;">Корзина</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="/find" style="padding: 10px 20px;">Поиск</a>
</li></ul>
          </div>
          <div class="u-custom-menu u-nav-container-collapse">
            <div class="u-black u-container-style u-inner-container-layout u-opacity u-opacity-95 u-sidenav">
              <div class="u-inner-container-layout u-sidenav-overflow">
                <div class="u-menu-close"></div>
                <ul class="u-align-center u-nav u-popupmenu-items u-unstyled u-nav-2"><li class="u-nav-item"><a class="u-button-style u-nav-link" href="/" style="padding: 10px 20px;">Главная страница</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="/profile" style="padding: 10px 20px;">Профиль</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="/basket" style="padding: 10px 20px;">Корзина</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="/find" style="padding: 10px 20px;">Поиск</a>
</li></ul>
              </div>
            </div>
            <div class="u-black u-menu-overlay u-opacity u-opacity-70"></div>
          </div>
        </nav>
      </div></header>

    <section class="u-clearfix u-section-1 u-grey-5" id="sec-82f7">
      <div id="to-insert" class="u-clearfix u-sheet u-valign-middle u-sheet-1">
        <h3 class="u-align-center u-text u-text-1">Ваш профиль</h3>

      </div>

        <section class="u-align-center u-clearfix u-section-1 u-grey-5" id="sec-da98">
            <h3 class="u-text u-text-1">Ваши заказы</h3>
            <p class="u-text u-text-2">Здесь вы можете следить за процессом обработки и доставки вашего заказа.</p>
        </section>
    </section>

  <script>
      window.onload = function () {
          login();
          loadTickets();
      }
      var mass;

      function setCookie(cName, cValue, expDays) {
          let date = new Date();
          date.setTime(date.getTime() + (expDays * 24 * 60 * 60 * 1000));
          const expires = "expires=" + date.toUTCString();
          document.cookie = cName + "=" + cValue + "; " + expires + "; path=/";
      }

      async function login() {
          var container = document.getElementById('to-insert');

          while (container.firstChild) {
              container.removeChild(container.firstChild);
          }

          let url = 'http://localhost:4040/getProfile';
          let it = document.cookie.split('; ');
          let email = '';
          let password = '';
          for(let i = 0; i < it.length; i++){
              let submass = it[i].split('=');
              if(submass[0] === 'password') {
                  password = submass[1];
              }
              if(submass[0] === 'email') {
                  email = submass[1];
              }
          }

          let response = await fetch(url, {
              method: 'GET',
              headers: {
                  'Content-type': 'application/json',
                  'email': email,
                  'password': password
              }
          });

          if (!response.ok) {
              alert("Ошибка HTTP: " + response.status);
              return;
          }

          let json = await response.json();
          let result = JSON.stringify(json);
          mass = JSON.parse(result);

          document.getElementById('to-insert').insertAdjacentHTML("beforeend", "        " +
              "<div  class=\"u-form u-form-1\">" +
              "<form action=\"#\" method=\"POST\" class=\"u-clearfix u-form-spacing-10 u-form-vertical u-inner-form\" source=\"custom\" name=\"form\" style=\"padding: 10px;\">\n" +
              "            <div class=\"u-form-group u-form-name\">\n" +
              "              <label for=\"name-319c\" class=\"u-form-control-hidden u-label\"></label>\n" +
              "              <input type=\"text\" placeholder=\""+mass['name']+"\" id=\"F1\" name=\"name\" class=\"u-border-1 u-border-grey-30 u-input u-input-rectangle u-white\" required=\"\">\n" +
              "            </div>\n" +
              "            <div class=\"u-form-group u-form-name u-form-group-2\">\n" +
              "              <label for=\"name-3e09\" class=\"u-form-control-hidden u-label\"></label>\n" +
              "              <input type=\"text\" placeholder=\""+mass['surname']+"\" id=\"F2\" name=\"surname\" class=\"u-border-1 u-border-grey-30 u-input u-input-rectangle u-white\" required=\"\">\n" +
              "            </div>\n" +
              "            <div class=\"u-form-email u-form-group\">\n" +
              "              <label for=\"email-319c\" class=\"u-form-control-hidden u-label\"></label>\n" +
              "              <input type=\"email\" placeholder=\""+mass['email']+"\" id=\"F3\" name=\"email\" class=\"u-border-1 u-border-grey-30 u-input u-input-rectangle u-white\" required=\"\">\n" +
              "            </div>\n" +
              "            <div class=\"u-form-group u-form-phone u-form-group-4\">\n" +
              "              <label for=\"phone-2be9\" class=\"u-form-control-hidden u-label\"></label>\n" +
              "              <input type=\"tel\" pattern=\"\\+?\\d{0,3}[\\s\\(\\-]?([0-9]{2,3})[\\s\\)\\-]?([\\s\\-]?)([0-9]{3})[\\s\\-]?([0-9]{2})[\\s\\-]?([0-9]{2})\" placeholder=\""+mass['phone']+"\" id=\"F4\" name=\"phone\" class=\"u-border-1 u-border-grey-30 u-input u-input-rectangle u-white\" required=\"\">\n" +
              "            </div>\n" +
              "            <div class=\"u-form-group u-form-group-5\">\n" +
              "              <label for=\"text-76dc\" class=\"u-form-control-hidden u-label\"></label>\n" +
              "              <input type=\"text\" placeholder=\"Ваш новый пароль\" id=\"F5\" name=\"password\" class=\"u-border-1 u-border-grey-30 u-input u-input-rectangle u-white\">\n" +
              "            </div>\n" +
              "            <div class=\"u-form-address u-form-group u-form-group-6\">\n" +
              "              <label for=\"address-e9c9\" class=\"u-form-control-hidden u-label\"></label>\n" +
              "              <input type=\"text\" placeholder=\""+mass['address']['country']+"\" id=\"F6\" name=\"country\" class=\"u-border-1 u-border-grey-30 u-input u-input-rectangle u-white\" required=\"\">\n" +
              "            </div>\n" +
              "            <div class=\"u-form-address u-form-group u-form-group-7\">\n" +
              "              <label for=\"address-de8e\" class=\"u-form-control-hidden u-label\"></label>\n" +
              "              <input type=\"text\" placeholder=\""+mass['address']['city']+"\" id=\"F7\" name=\"city\" class=\"u-border-1 u-border-grey-30 u-input u-input-rectangle u-white\" required=\"\">\n" +
              "            </div>\n" +
              "            <div class=\"u-form-address u-form-group u-form-group-8\">\n" +
              "              <label for=\"address-08d4\" class=\"u-form-control-hidden u-label\"></label>\n" +
              "              <input type=\"text\" placeholder=\""+mass['address']['street']+"\" id=\"F8\" name=\"street\" class=\"u-border-1 u-border-grey-30 u-input u-input-rectangle u-white\" required=\"\">\n" +
              "            </div>\n" +
              "            <div class=\"u-form-address u-form-group u-form-group-9\">\n" +
              "              <label for=\"address-283b\" class=\"u-form-control-hidden u-label\"></label>\n" +
              "              <input type=\"text\" placeholder=\""+mass['address']['house']+"\" id=\"F9\" name=\"house\" class=\"u-border-1 u-border-grey-30 u-input u-input-rectangle u-white\" required=\"\">\n" +
              "            </div>\n" +
              "            <div class=\"u-form-address u-form-group u-form-group-10\">\n" +
              "              <label for=\"address-fb83\" class=\"u-form-control-hidden u-label\"></label>\n" +
              "              <input type=\"text\" placeholder=\""+mass['address']['flat']+"\" id=\"F10\" name=\"flat\" class=\"u-border-1 u-border-grey-30 u-input u-input-rectangle u-white\" required=\"\">\n" +
              "            </div>\n" +
              "            <div class=\"u-align-left u-form-group u-form-submit\">\n" +
              "              <a id=\"INPUT\" href=\"\" class=\"u-btn u-btn-submit u-button-style\">Отправить</a>\n" +
              "              <input type=\"submit\" value=\"submit\" class=\"u-form-control-hidden\">\n" +
              "            </div>\n" +
              "          </form>" +
              "        </div>");
          document.getElementById("INPUT").addEventListener("mousedown", async function () {
              let url = 'http://localhost:4040/login';

              let it = document.cookie.split('; ');
              let email = '';
              let password = '';
              for(let i = 0; i < it.length; i++){
                  let submass = it[i].split('=');
                  if(submass[0] === 'password') {
                      password = submass[1];
                  }
                  if(submass[0] === 'email') {
                      email = submass[1];
                  }
              }

              let NewMass = [];

              for(let i = 0; i < 10; i++){
                  if(document.getElementById('F' + (i + 1)).value !== ""){
                      NewMass[i] = document.getElementById('F' + (i + 1)).value;
                  }
                  else{
                      if(document.getElementById('F' + (i + 1)).name === 'flat' ||
                          document.getElementById('F' + (i + 1)).name === 'house' ||
                          document.getElementById('F' + (i + 1)).name === 'street' ||
                          document.getElementById('F' + (i + 1)).name === 'city' ||
                          document.getElementById('F' + (i + 1)).name === 'country'){
                          NewMass[i] = mass['address'][document.getElementById('F' + (i + 1)).name];
                      }
                      else {
                          NewMass[i] = mass[document.getElementById('F' + (i + 1)).name];
                      }
                  }
              }

              var data = JSON.stringify({
                  "address": {
                      "city": NewMass[5],
                      "country": NewMass[6],
                      "flat": NewMass[7],
                      "house": NewMass[8],
                      "street": NewMass[9]
                  },
                  "email": NewMass[2],
                  "id": 0,
                  "name": NewMass[0],
                  "password": NewMass[4],
                  "phone": NewMass[3],
                  "surname": NewMass[1]});

              fetch(url, {
                  method: 'put',
                  body: data,
                  headers: new Headers({
                      'Content-Type': 'application/json',
                      'email': email,
                      'password': password
                  })
              }).then(function(response) {
                  if (!response.ok) {
                      throw new Error("HTTP status " + response.status);
                  }
                  else{
                      setCookie('email', NewMass[2], 365);
                      setCookie('password', NewMass[4], 365);
                  }
              })
              window.setTimeout(function () {
                  login();
              }, 2000);
          });
      }
  </script>



      <footer class="u-align-center u-clearfix u-footer u-grey-80 u-footer" id="sec-1f20"><div class="u-align-left u-clearfix u-sheet u-sheet-1"></div></footer>
    <section class="u-backlink u-clearfix u-grey-80">
    </section>
  </body>
</html>